#########################
# Gatling Configuration #
#########################

gatling {
  core {
    # Output folder name (relative to results directory)
    outputDirectoryBaseName = "redispatch-loadtest"

    # Run description for the reports
    runDescription = "TSO Redispatch Load Test"

    # Encoding
    encoding = "utf-8"

    # Simulation class name
    simulationClass = ""

    # Enable?/disable? file content caching
    extract {
      regex {
        cacheMaxCapacity = 200
      }
      xpath {
        cacheMaxCapacity = 200
      }
      jsonPath {
        cacheMaxCapacity = 200
      }
      css {
        cacheMaxCapacity = 200
      }
    }

    # Directory where results are stored
    directory {
      results = "target/gatling"
      bodies = ""
      simulations = ""
    }
  }

  socket {
    # Timeout for establishing connections
    connectTimeout = 10000

    # Timeout when a used connection stays idle
    tcpNoDelay = true

    # Use SO_KEEPALIVE
    soKeepAlive = false
  }

  netty {
    # Use native transports
    useNativeTransport = true

    # Allocator type
    allocator = "pooled"

    # Maximum length of request line
    maxInitialLineLength = 65536

    # Maximum size of HTTP headers
    maxHeaderSize = 20000

    # Maximum size of chunks
    maxChunkSize = 8192

    # Use direct buffer
    useDirectArenas = true
  }

  http {
    # Cache EL function bodies
    elFileBodiesCacheMaxCapacity = 200

    # Warm up JVM
    warmUpUrl = ""

    ssl {
      useOpenSsl = true
      useOpenSslFinalizers = false
      handshakeTimeout = 10000
      useInsecureTrustManager = false
    }

    # Advanced configuration for HTTP protocol
    ahc {
      # Timeout for requests
      requestTimeout = 60000

      # Timeout for pooled connections
      pooledConnectionIdleTimeout = 600000  # 10 minutes for SSE

      # Max connections per host
      maxConnectionsPerHost = 2000

      # Enable HTTP/2
      enableHttp2 = false

      # Enable hostname verification
      enableHostnameVerification = false
    }

    dns {
      queryTimeout = 5000
      maxQueriesPerResolve = 6
    }
  }

  jms {
    replyTimeoutScanPeriod = 1000
  }

  data {
    # Data writers for simulation results
    writers = [console, file]

    console {
      # Write interval for console output
      light = false
      writePeriod = 5
    }

    file {
      # Buffer size for file writing
      bufferSize = 8192
    }

    leak {
      noActivityTimeout = 30
    }

    graphite {
      # Graphite integration (disabled by default)
      # host = "localhost"
      # port = 2003
      # protocol = "tcp"
      # rootPathPrefix = "gatling"
      # bufferSize = 8192
      # writePeriod = 1
    }
  }
}
